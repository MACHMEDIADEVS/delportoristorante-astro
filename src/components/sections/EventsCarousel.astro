---
/* src/components/sections/EventsCarousel.astro */
import { Swiper } from "swiper";
import { Navigation, Pagination, Autoplay } from "swiper/modules";
import "swiper/css";
import "swiper/css/navigation";
import "swiper/css/pagination";

import { fakeEvents } from "../../utils/fakeData";
import CardEvent from "../ui/CardEvent.astro";

const events = fakeEvents;
const upcomingEvents = events.filter(
  (event) => event.main_data.status_event === "Open"
);
---

<section class="events-carousel-section py-5 bg-darker">
  <div class="container">
    <h3 class="text-center text-gold">Our Upcoming Events</h3>
    <div class="swiper events-swiper pt-5">
      <div class="swiper-wrapper">
        {
          upcomingEvents.map((event) => (
            <div class="swiper-slide">
              <CardEvent event={event} />
            </div>
          ))
        }
      </div>
      <div class="swiper-pagination"></div>
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
  </div>
</section>

<script>
  import Swiper from "swiper";
  import { Navigation, Pagination, Autoplay } from "swiper/modules";

  Swiper.use([Navigation, Pagination, Autoplay]);
  document.addEventListener("DOMContentLoaded", () => {
    new Swiper(".events-swiper", {
      slidesPerView: 1,
      spaceBetween: 30,
      loop: true,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      breakpoints: {
        768: {
          slidesPerView: 2,
          slidesPerGroup: 1,
        },
        992: {
          slidesPerView: 3,
          slidesPerGroup: 1,
        },
      },
    });
  });
</script>

<style lang="scss">
  .events-carousel-section {
    .swiper {
      padding-bottom: 3rem;

      .swiper-slide {
        height: auto;
        display: flex;
        justify-content: center;
        align-items: stretch;
      }
    }

    .swiper-button-next,
    .swiper-button-prev {
      color: var(--gold) !important;
      top: 40%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      background-color: rgba(0, 0, 0, 0.5);
      border-radius: 0;
      opacity: 0.8;
      transition:
        opacity 0.3s ease,
        background-color 0.3s ease;

      &::after {
        font-size: 1.2rem;
      }

      &:hover {
        opacity: 1;
        background-color: rgba(0, 0, 0, 0.7);
      }
    }

    .swiper-button-prev {
      left: 0;
    }
    .swiper-button-next {
      right: 0;
    }

    .swiper-pagination-bullet {
      background-color: var(--txt-muted);
      opacity: 0.8;
      transition: background-color 0.3s ease;

      &-active {
        background-color: var(--gold) !important;
        opacity: 1;
      }
    }
  }
</style>
